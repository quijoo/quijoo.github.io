<!DOCTYPE html>
<html id="bg">

<head>
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />
    <meta charset="utf-8" />
<!--
    * @Theme Card
    * @Author admin@itjoker.cn
    * @Link https://blog.itjoker.cn
-->

<title>
    Island and Winds
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://fastly.jsdelivr.net">
<meta name="author" content="Island and Winds">
<meta name="description" content="记录学习和生活 💕">
<meta name="keywords" content="code,life,sleep">
<meta name="gridea-theme" content="Card">
<meta name="spider" content="https://nmsl.sbjxw.网址">
<meta name="UpdateTime" content="1667771736332">
<script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io/CDN/js/jquery@3.4.1.min.js"></script>

<!-- <script src="http://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> -->

<link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://fastly.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io/CDN/js/Card/prism.min.js"></script>
<link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.36/CDN/css/Card/prism.min.css" />
<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css">
<script src="https://fastly.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/katex@0.10.0-beta/dist/contrib/auto-render.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>
<!--<script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.36/CDN/js/Card/script.min.js"></script>
<link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.36/CDN/css/Card/main.min.css" />-->
<!-- use my domain directly -->
<script src="https://xuaii.github.io/media/js/script.min.js"></script>
<link rel="stylesheet" href="https://xuaii.github.io/media/css/main.min.css" />
<link rel="stylesheet" href="https://xuaii.github.io/styles/main.css" />
<!-- <script src="https://xuaii.github.io/media/js/script.min.js"></script>
<link rel="stylesheet" href="https://xuaii.github.io/media/css/main.min.css" />
<link rel="stylesheet" href="https://xuaii.github.io/styles/main.css" /> -->

<link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.36/CDN/css/Card/iconfont.css" />
<!--link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_410989_wuhl0k5ojvf.css" /-->
<link href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.36/CDN/js/love.min.js"></script>
<script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
<!-- 添加的关于 markdown 内容 -->
<!-- <script src=https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js></script>
<script src="https://cdn.bootcss.com/marked/0.3.6/marked.min.js"></script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/railscasts.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script> -->

<script>
    $().ready(
        function() {
            if (window.localStorage.getItem('first_visit') != 1) {
                window.localStorage.setItem('theme', window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
                window.localStorage.setItem('first_visit', 1);
            }
            var themeIcon = document.getElementById("themeIcon");
            var currentTheme = window.localStorage.getItem('theme');
            if (currentTheme == 'dark') {
                imgList = document.getElementsByTagName('img');
                for (let i = 0; i < imgList.length; i++) {
                    imgList[i].style.cssText = mediaCssText;
                }
                document.documentElement.style.cssText = cssText;
                document.getElementsByClassName('card-bg')[0].style.cssText = mediaCssText;
                themeIcon.classList.remove('Card-moon');
                themeIcon.classList.add('Card-sun');
            } else {
                imgList = document.getElementsByTagName('img');
                for (let i = 0; i < imgList.length; i++) {
                    imgList[i].style.cssText = '';
                }
                document.documentElement.style.cssText = '';
                document.getElementsByClassName('card-bg')[0].style.cssText = '';
                document.getElementsByTagName('html')[0].setAttribute('id', 'bg');
                themeIcon.classList.remove('Card-sun');
                themeIcon.classList.add('Card-moon');
            }
        }
    )
</script>

    <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io/CDN/js/hit-kounter-lc-0.3.0.js"></script>
    
        
            <script>
                (function() {
                    var bp = document.createElement('script');
                    var curProtocol = window.location.protocol.split(':')[0];
                    if (curProtocol === 'https') {
                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                    } else {
                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                    }
                    var s = document.getElementsByTagName("script")[0];
                    s.parentNode.insertBefore(bp, s);
                })();
            </script>
            
                <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y4KTS4B2P0"></script>
                <script>
                    window.dataLayer = window.dataLayer || [];

                    function gtag() {
                        dataLayer.push(arguments);
                    }
                    gtag('js', new Date());
                    gtag('config', 'G-Y4KTS4B2P0');
                </script>
                
                    <style>
                        .Card-certify {
                            color: #0091e4 !important;
                        }
                        
                        #foot {
                            color: #666666;
                        }
                        
                        #menu-item:hover {
                            border-bottom: 1px solid rgba(0, 0, 0, 0.5);
                            border-bottom-color: rgba(0, 0, 0, .6);
                        }
                        
                        .gray {
                            -webkit-filter: grayscale(100%);
                            /* webkit */
                            -moz-filter: grayscale(100%);
                            /*firefox*/
                            -ms-filter: grayscale(100%);
                            /*ie9*/
                            -o-filter: grayscale(100%);
                            /*opera*/
                            filter: grayscale(100%);
                            filter: progid: DXImageTransform.Microsoft.BasicImage(grayscale=1);
                            filter: gray;
                            /*ie9- */
                        }
                        
                        .lite-item,
                        #header {
                            opacity: 1;
                        }
                        
                        .lite-item {
                            background-color: #fafafa;
                        }
                        
                        #btnStyle:hover {
                            transition: all .3s ease;
                            /*color: #fff;*/
                            /*background-color: #6b6b6b;*/
                            background-color: #eaeaea;
                            /*#0092ee*/
                            /*linear-gradient( rgb(138, 160, 255) 30%, rgb(90, 140, 250) 70%);*/
                        }
                        
                        #btnStyle {
                            /*background-color: #efefef;*/
                            font-size: 14px;
                            transition: all .3s ease;
                        }
                        
                        .link_a:hover {
                            margin-top: 10px;
                            margin-bottom: 10px;
                            color: #fff;
                            border-left: 8px solid #6b6b6b;
                            padding: 5px;
                            transition: all .3s ease;
                        }
                        
                        html {
                            width: 100%;
                            height: 100%;
                            background-attachment: fixed;
                            background-repeat: no-repeat;
                        }
                    </style>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>
    <header id="header">

    <div id="pc-menu">
        <a id="menu-bar" class="Card Card-menu"></a>
        <a id="menu-title" href="https://xuaii.github.io">
            Island and Winds
        </a>
        <nav id="menu-main" class="menu-main">
            <ul>
                <li id="menu-item" class="menu-item">
                    <div id="tp-weather-widget"></div>
                </li>
                
                    <li id="menu-item" class="menu-item">
                        <a href="/">
                            🎈首页
                        </a>
                    </li>
                    
                    <li id="menu-item" class="menu-item">
                        <a href="/archives">
                            📒归档
                        </a>
                    </li>
                    
                    <li id="menu-item" class="menu-item">
                        <a href="/tags">
                            🏷️标签
                        </a>
                    </li>
                    
                    <li id="menu-item" class="menu-item">
                        <a href="/posts">
                            📄文章
                        </a>
                    </li>
                    
                    <li id="menu-item" class="menu-item">
                        <a href="/post/record">
                            ☔记录
                        </a>
                    </li>
                    
                    <li id="menu-item" class="menu-item">
                        <a href="/post/about">
                            🧶关于
                        </a>
                    </li>
                    
            </ul>
        </nav>
        <form id="gridea-search-form" class="searchform" data-update="1667771736332" action="/search/index.html">
            <i class="Card Card-search"></i>
            <input id="s" class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
        </form>
    </div>
    <div id="mobile-menu">
        <form id="gridea-search-form" class="mobile-searchform" data-update="1667771736332" action="/search/index.html">
            <i class="Card Card-search"></i>
            <input id="s" class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
        </form>
        <nav class="menu">
            <ul style="list-style: none;">
                
                    <li class="page_item page-item-2">
                        <a href="/">
                            🎈首页
                        </a>
                    </li>
                    
                    <li class="page_item page-item-2">
                        <a href="/archives">
                            📒归档
                        </a>
                    </li>
                    
                    <li class="page_item page-item-2">
                        <a href="/tags">
                            🏷️标签
                        </a>
                    </li>
                    
                    <li class="page_item page-item-2">
                        <a href="/posts">
                            📄文章
                        </a>
                    </li>
                    
                    <li class="page_item page-item-2">
                        <a href="/post/record">
                            ☔记录
                        </a>
                    </li>
                    
                    <li class="page_item page-item-2">
                        <a href="/post/about">
                            🧶关于
                        </a>
                    </li>
                    
            </ul>
        </nav>
    </div>
    <a id="theme-btn" class="theme-btn" onclick="App.changeTheme()"><i id="themeIcon" class="Card Card-moon"></i></a>
</header>
        <div id="main">
            <div id="main-part">
                <div class="lite-item">
                    <article class="post post-type real-post">
                        <header class="post-type-header">
                            
                                    <div class="thumbnail-link" style="background-color: transparent;"></div>
                                    
                                        <div class="thumbnail-shadow">
                                            <h1 class="post-title">
                                                [计算机组成原理] 计算机指令系统
                                            </h1>
                                            <div class="post-info">
                                                <span class="post-category"><i class="Card Card-novel"></i>
                                        
                                            <span onclick="javascript:top.location='https://xuaii.github.io/tag/q7ogHTpxn/'">计算机组成原理</span>
                                                
                                            <span onclick="javascript:top.location='https://xuaii.github.io/tag/nk7eMi6weI/'">CPU</span>
                                                
                                            <span onclick="javascript:top.location='https://xuaii.github.io/tag/y0QD2lmwzR/'">指令集</span>
                                                
                                                    </span>
                                                    <span class="post-view">
                                                    
                                                        &nbsp;•&nbsp;
                                                    <span id="/post/ji-suan-ji-zhi-ling-xi-tong/" class="leancloud_visitors" data-flag-title="[计算机组成原理] 计算机指令系统">
                                                <i class="Card Card-view"></i>&nbsp;阅读量&nbsp;
                                                <i class="leancloud-visitors-count">0</i>
                                            </span>

                                                    
                                                            </span>&nbsp;•&nbsp;

                                                            <span class="post-readtime">阅读时间:
                                            21.8分</span>
                                                            <span class="post-edit"></span></div>
                                        </div>
                                        <div class="post-relative">
                                            <img alt="Island and Winds" src="https://xuaii.github.io/images/avatar.png?v=1667771736332" srcset="https://xuaii.github.io/images/avatar.png?v=1667771736332" class="avatar avatar-100 photo" width="100" height="100">
                                            <span class="post-type-author"><a href="https://xuaii.github.io" title="由Island and Winds发布" rel="author">Island and Winds<i class="Card Card-certify"></i></a></span>
                                            <span class="post-publish"><i class="fa fa-calendar" aria-hidden="true"></i>&nbsp;2022-08-30</span>
                                        </div>
                        </header>
                        

                        <div class="post-main post-type-main">
                            <div class="post-content">
                                <div class="post-content-real">
                                    <h2 id="指令">指令</h2>
<p>计算机指令是机器码，是汇编码，是硬件软件交互界面；指令长度是CPU指令长度（例如：32<br>
位/64位）<br>
常规的指令形式是 OP + Address * n;<br>
指令字长和机器字长没有固定关系，通常有半指令字长，单指令字长，双指令字长，此外指令长度可以是固定的也可以是不定的，通常来说定长指令更易于处理</p>
<ol>
<li>
<p>零地址指令</p>
<ul>
<li>不需要操作数的指令(空操作，停机，关中断指令)，</li>
<li>堆栈计算机指令</li>
</ul>
</li>
<li>
<p>一地址指令</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mi>P</mi><mo>(</mo><msub><mi>A</mi><mn>1</mn></msub><mo>)</mo><mo>→</mo><msub><mi>A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">OP(A_1)\rightarrow A_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>(自增,自减,求反求补)</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>A</mi><mi>C</mi><mi>C</mi><mo>)</mo><mi>O</mi><mi>P</mi><mo>(</mo><mi>A</mi><mo>−</mo><mn>1</mn><mo>)</mo><mo>→</mo><mi>A</mi><mi>C</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">(ACC)OP(A-1)\rightarrow ACC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>, 隐含约定地址， 计算寻址范围</li>
</ul>
</li>
<li>
<p>二地址指令<br>
算术指令，逻辑运算指令<br>
指令含义 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>A</mi><mn>1</mn></msub><mo>)</mo><mi>O</mi><mi>P</mi><mo>(</mo><msub><mi>A</mi><mn>2</mn></msub><mo>)</mo><mo>→</mo><msub><mi>A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">(A_1)OP(A_2)\rightarrow A_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>三地址指令<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>A</mi><mn>1</mn></msub><mo>)</mo><mi>O</mi><mi>P</mi><mo>(</mo><msub><mi>A</mi><mn>2</mn></msub><mo>)</mo><mo>→</mo><msub><mi>A</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">(A_1)OP(A_2)\rightarrow A_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 如果地址均为主存地址， 完成该类指令需要四次访存(取指令 * 1， 取操作数<em>2， 存放结果</em>1)</p>
</li>
<li>
<p>四地址指令<br>
最后一个地址 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">A_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是下一条将要执行的指令</p>
</li>
</ol>
<h2 id="指令扩展">指令扩展</h2>
<p>虽然现代处理器采用大都采用定长指令，但是为了在此基础上保留指令的丰富类别，采用可变长操作码的定长指令；这意味着操作码位数长度不变，且分散在指令的不同位置，这将增加指令的译码难度，增加控制器复杂度。</p>
<h2 id="指令操作类型">指令操作类型</h2>
<p><strong>数据传送</strong></p>
<ol>
<li>寄存器之间的传送(MOV)</li>
<li>从内存单元读取数据到CPU寄存器(LOAD)</li>
<li>从CPU寄存器写数据到内存单元(STORE)</li>
</ol>
<p><strong>算术和逻辑</strong><br>
加(ADD)、 减(SUB)、 乘(MUL)、 除(DIV)、 比较(CMP)、 加1(INC)、 减1(DEC)、 与(AND)、或(OR)、 取反(NOT)、 亦或(XOR)</p>
<p><strong>移位操作</strong><br>
算法移位、逻辑移位、循环移位</p>
<p><strong>转移操作</strong></p>
<ol>
<li>无条件转移(JMP)</li>
<li>条件转移(BRANCH)</li>
<li>调用(CALL)</li>
<li>返回(RET)</li>
<li>陷阱(TRAP)</li>
</ol>
<p><strong>输入输出操作</strong><br>
完成 CPU 与外部设备交换数据或传送控制命令及状态信息</p>
<h2 id="指令寻址方式">指令寻址方式</h2>
<p>'' <strong>寻址方式</strong>是指寻找指令或指令操作数有效地址的方式 ''<br>
寻址方式分为<strong>指令寻址</strong>和<strong>数据寻址</strong>两类</p>
<p>指令中数据字段代表的不是真实地址而是<strong>形式地址</strong>， 形式地址结合<strong>寻址方式</strong>可以计算真实地址<br>
如果 A 表示<strong>寄存器编号</strong>或者<strong>内存地址</strong>， 那么 (A) 表示其中保存的值</p>
<h3 id="指令寻址">指令寻址</h3>
<ol>
<li>顺序寻址: 程序计数器PC++，自动形成下一条指令地址</li>
<li>跳跃寻址:<br>
跳跃寻址的地址依然是由 PC 寄存器指出的， 指令跳跃收到 <strong>状态寄存器</strong> 和 <strong>操作数</strong>的控制，跳跃地址可以是直接由标记符得到，也可以由当前指令偏移得到；即 <strong>绝对地址</strong> 和 <strong>相对地址</strong></li>
</ol>
<h3 id="数据寻址">数据寻址</h3>
<p>本质是如何在指令中 <strong>表示</strong> 操作数的地址，如何用这种表示计算出 <strong>操作数地址</strong></p>
<ol>
<li>
<p>隐含寻址<br>
例如单地址指令中隐含的地址一样，操作数地址隐含在操作码的定义里</p>
</li>
<li>
<p>立即数寻址<br>
补码表示操作数直接在指令中给出，例如 ADD 1 1<br>
<strong>优点</strong> 是过程中不用访存<br>
<strong>缺点</strong> 立即数长度限制了立即数范围</p>
</li>
<li>
<p>直接寻址<br>
直接在指令中指出<strong>操作数地址</strong>的真实值<br>
<strong>优点</strong> 是简单仅访问一次内存<br>
<strong>缺点</strong> 是指令长度决定了地址的上限，操作数的地址修改不容易！</p>
</li>
<li>
<p>间接寻址<br>
指令地址给出<strong>操作数地址</strong>所在<strong>储存单元的地址</strong>， 也就是需要一次间接寻址，间接寻址也可以是多次间接寻址，通过主存中取得的字的<strong>第一位</strong>的取值判断是否是取得操作数地址：</p>
<ul>
<li>取 0， 表示当前地址是操作数地址</li>
<li>取 1， 表示当前地址是操作数间址<br>
<strong>优点</strong> 扩大寻址范围，方便子程序返回<br>
<strong>缺点</strong> 多次访存， 一般扩大寻址地址的方法是寄存器间接寻址</li>
</ul>
</li>
<li>
<p>寄存器寻址<br>
直接在指令字中给出操作数所在寄存器编号</p>
<p><strong>优点</strong>  不访问主存，执行速度快， 支持向量矩阵运算<br>
<strong>缺点</strong> 寄存器价格贵，数量有限</p>
</li>
<li>
<p>寄存器间接寻址<br>
在指令字中给出寄存器编号，该寄存器内存储操作数的地址<br>
<strong>优点</strong> 速度更快，用于扩展寻址范围<br>
<strong>缺点</strong> 只能一次间址，需要访问主存</p>
</li>
<li>
<p>相对寻址<br>
相对寻址是相对于 PC 上加上指令偏移量 A 而形成的有效地址，A 可正可负，补码表示<br>
<strong>优点</strong> 操作数地址不固定，广泛用于<strong>转移指令</strong><br>
<strong>缺点</strong> A 的位数决定寻址范围<br>
<strong>注意</strong> PC 寄存器取下一条指令后自增，然后再加上偏移量</p>
</li>
<li>
<p>基址寻址<br>
实际地址 EA = (BR) + A，即基址 + 形式地址。基址寄存器是<strong>面向操作系统</strong>的，主要解决程序逻辑空间与储存器物理空间无关<br>
<strong>优点</strong> 扩大寻址范围，利于多道程序设计，利于编写非线性程序（浮动程序），用于各种页表，段表实现<br>
<strong>缺点</strong> 形式地址位数较短</p>
</li>
<li>
<p>变址寻址<br>
变址寄存器寻址是 形式地址 A + 变址寄存器 IX，这里的变址寄存器区别于基址寄存器，是<strong>面向用户</strong>的，其中 IX 的位数足以表示整个存储空间<br>
<strong>优点</strong> 扩大寻址范围，便于编制循环程序，用于实现数组，因为指令中的 A 是<strong>固定的</strong>， 而IX是可以由用户设定的<br>
<strong>缺点</strong> A 不可变？硬找借口？</p>
</li>
<li>
<p>堆栈寻址<br>
堆栈是存储器(或专用寄存器)中一块特定的，后进先出的(LIFO) 原则管理的存储区，该存储区中 读/写单元的地址使用一个特定<strong>寄存器SP</strong>给出的，硬堆栈/软堆栈。<br>
<strong>硬堆栈</strong> 是寄存器堆栈，速度快，成本高，不适合做大容量堆栈<br>
<strong>软堆栈</strong> 是主存中划分的一段区域，速度稍慢，成本低，适合大容量</p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">寻址方式</th>
<th style="text-align:center">有效地址</th>
<th style="text-align:center">访存次数</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">隐含寻址</td>
<td style="text-align:center">程序指定</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">立即寻址</td>
<td style="text-align:center">A是操作数</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">直接寻址</td>
<td style="text-align:center">EA=A</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">一次间接寻址</td>
<td style="text-align:center">EA=(A)</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">寄存器寻址</td>
<td style="text-align:center">EA=R_i</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">寄存器一次间接寻址</td>
<td style="text-align:center">EA=(R_i)</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">相对寻址</td>
<td style="text-align:center">EA=(PC)+A</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">基址寻址</td>
<td style="text-align:center">EA=(BR)+A</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">变址寻址</td>
<td style="text-align:center">EA=(IX)+A</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
<h2 id="程序的机器码表示-汇编">程序的机器码表示 - 汇编</h2>
<p>x86 处理器中包含8个32位通用寄存器</p>
<table>
<thead>
<tr>
<th style="text-align:center">寄存器名称</th>
<th style="text-align:center">位数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">EAX</td>
<td style="text-align:center">32</td>
<td style="text-align:center">累加器(Accumulator)</td>
</tr>
<tr>
<td style="text-align:center">EBX</td>
<td style="text-align:center">32</td>
<td style="text-align:center">基址寄存器(Base Register)</td>
</tr>
<tr>
<td style="text-align:center">ECX</td>
<td style="text-align:center">32</td>
<td style="text-align:center">计数寄存器(Count Register)</td>
</tr>
<tr>
<td style="text-align:center">EDX</td>
<td style="text-align:center">32</td>
<td style="text-align:center">数据寄存器(Data Register)</td>
</tr>
<tr>
<td style="text-align:center">ESI</td>
<td style="text-align:center">32</td>
<td style="text-align:center">变址寄存器(Index Register)</td>
</tr>
<tr>
<td style="text-align:center">EDI</td>
<td style="text-align:center">32</td>
<td style="text-align:center">变址寄存器(Index Register)</td>
</tr>
<tr>
<td style="text-align:center">EBP</td>
<td style="text-align:center">32</td>
<td style="text-align:center">堆栈基指针(Base Pointer)</td>
</tr>
<tr>
<td style="text-align:center">ESP</td>
<td style="text-align:center">32</td>
<td style="text-align:center">堆栈顶指针(Stack Pointer)</td>
</tr>
</tbody>
</table>
<p><strong>说明</strong> 前四个寄存器 EAX, EBX, ECX, EDX 都是32位寄存器，但是可以仅仅访问其中的半字例如：(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi>A</mi><mi>X</mi><mo>=</mo><mi>A</mi><mi>H</mi><mo>+</mo><mi>A</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">EAX = AH + AL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">L</span></span></span></span>), 除EBP和ESP外，其余寄存器的使用是比较任意的。</p>
<p>x64 汇编增加了几个寄存器和引入新的指令格式，在此仅学习 x86汇编。</p>
<h3 id="环境配置">环境配置</h3>
<p>vscode + MASM/TASM 插件<br>
测试代码如下：</p>
<pre><code class="language-nasm">DATA SEGMENT
    MESG DB &quot;This is an Assembly Language Programe.&quot;, 0DH, 0AH, &quot;$&quot;
    SPACE DB &quot; &quot;, &quot;$&quot;
DATA ENDS
CODE SEGMENT
    ASSUME CS:CODE, DS:DATA
    START:
        MOV AX, DATA
        MOV DS, AX              ; 将 DATA 段的段首址存入 DS
        MOV BX, 01H             ; BX 初始值设为 1
    AGAIN:
        MOV DX, OFFSET MESG     ; 取欲显示的字符偏移量赋给 DX
        MOV AH, 09H             ; 调用 9号(显示)DOS功能子程序
        INT 21H
        MOV CX, BX              ; 将 BX 的值赋给 CX
        INC BX
    NEXT:
        MOV DX, OFFSET SPACE    ; 取空格字符偏移量赋给 DX
        MOV AH, 09H
        INT 21H
        LOOP NEXT               ; 继续显示空格字符，直到 CX 为 0
        CMP BX, 10              ; BX 与 10 比较
        JBE AGAIN               ; 没显示 10 次，转移到 AGAIN 继续执行程序
        MOV AH, 4CH
        INT 21H                 ; 返回 DOS
CODE ENDS
END START
</code></pre>
<p>右键 运行/调试</p>
<h3 id="汇编指令格式">汇编指令格式</h3>
<p>AT&amp;T格式和Intel格式区别如下</p>
<table>
<thead>
<tr>
<th style="text-align:center">项目/区别</th>
<th style="text-align:center">AT&amp;T</th>
<th style="text-align:center">Intel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">大小写</td>
<td style="text-align:center">小写</td>
<td style="text-align:center">大小写不敏感</td>
</tr>
<tr>
<td style="text-align:center">操作数</td>
<td style="text-align:center">第一个为源操作数,第二个为目的操作数</td>
<td style="text-align:center">第一个位目的操作数，第一个为源操作数</td>
</tr>
<tr>
<td style="text-align:center">前缀</td>
<td style="text-align:center">寄存器前缀%，立即数前缀$</td>
<td style="text-align:center">不需要前缀</td>
</tr>
<tr>
<td style="text-align:center">寻址</td>
<td style="text-align:center">使用&quot;(&quot;和&quot;)&quot;</td>
<td style="text-align:center">使用&quot;[&quot; 和 &quot;]&quot;</td>
</tr>
<tr>
<td style="text-align:center">复杂寻址</td>
<td style="text-align:center">disp(base, index, scale), 表示偏移量，基址寄存器， 变址寄存器，比例因子;如 8(%edx, %eax, 2)</td>
<td style="text-align:center">[edx+eax*2+8]</td>
</tr>
<tr>
<td style="text-align:center">数据长度</td>
<td style="text-align:center">在操作码后边一个字符表示操作数大小 b-&gt;byte, w-&gt;word, l-&gt;long</td>
<td style="text-align:center">显式的注明byte ptr, word ptr, dword ptr</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong> 由于32位或64位体系结构都是由16位扩展而来，因此用 word(字) 表示16位</p>
<h3 id="常用机器指令">常用机器指令</h3>
<p>汇编指令通常可以分为 <strong>数据传送指令</strong>， <strong>逻辑计算指令</strong>， <strong>控制流指令</strong><br>
以下以** Intel 格式**为例介绍重要指令:<br>
<strong>约定</strong><br>
&lt;reg32&gt; 表示eax,ebx,edx,....<br>
&lt;reg16&gt; 表示ax, bx, dx<br>
&lt;reg8&gt;   表示ah, al, bh,bl,...<br>
&lt;mem&gt;  表示内存地址，如[eax]、[var+4]、dword ptr [eax+ebx]<br>
&lt;con&gt;   表示8位、16位或32位常数</p>
<p><strong>mov 指令</strong><br>
将 <strong>第二个操作数</strong>(寄存器，内存，常数内容) 复制到 <strong>第一个操作数</strong>(寄存器或内存)，不能用于内存到内存的复制</p>
<pre><code class="language-nasm">mov     &lt;reg&gt;,&lt;reg&gt;
mov     &lt;reg&gt;,&lt;mem&gt;
mov     &lt;mem&gt;,&lt;reg&gt;
mov     &lt;reg&gt;,&lt;con&gt;
mov     &lt;mem&gt;,&lt;con&gt;
</code></pre>
<p><strong>push 指令</strong><br>
将操作数压入内存的栈，常用于函数调用。ESP 是栈顶指针，压栈前 ESP-=4，栈增长方向与内存地址增长方向相反，然后将操作数压入 ESP 指示的地址</p>
<pre><code class="language-nasm">push     &lt;reg32&gt;
push     &lt;mem&gt;
push     &lt;con32&gt;
// 栈元素固定 32 位 eg:
push     eax
push     [var]
</code></pre>
<p><strong>pop 指令</strong><br>
将栈顶元素送出，pop指令将 ESP 地址内容出栈，再将 ESP 值加 4</p>
<pre><code class="language-nasm">pop     edi
pop     [ebx]
</code></pre>
<p><strong>add/sub 指令</strong><br>
将两个操作数相加/减，结果保存到第一个操作数中</p>
<pre><code class="language-nasm">add     &lt;reg&gt;,&lt;reg&gt; / sub &lt;reg&gt;,&lt;reg&gt;
add     &lt;reg&gt;,&lt;mem&gt; / sub &lt;reg&gt;,&lt;mem&gt;
add     &lt;mem&gt;,&lt;reg&gt; / sub &lt;mem&gt;,&lt;reg&gt;
add     &lt;reg&gt;,&lt;con&gt; / sub &lt;reg&gt;,&lt;con&gt;
add     &lt;mem&gt;,&lt;con&gt; / sub &lt;mem&gt;,&lt;con&gt;
</code></pre>
<p><strong>inc/dec 指令</strong><br>
操作数自增自减指令</p>
<pre><code class="language-nasm">inc     &lt;reg&gt; / dec &lt;reg&gt;
inc     &lt;mem&gt; / dec &lt;mem&gt;
// eg:
dec eax
inc     dword ptr [var]
</code></pre>
<p><strong>imul 指令</strong><br>
带符号整数乘法指令，有两种形式 1. 两个操作数相加结果保存到<strong>第一个操作数</strong> 2. 三个操作数后两个数相加结果保存到<strong>第一个操作数</strong></p>
<pre><code class="language-nasm">imul     &lt;reg32&gt;,&lt;reg32&gt;
imul     &lt;reg32&gt;,&lt;mem&gt;
imul     &lt;reg32&gt;,&lt;reg32&gt;,&lt;con&gt;
imul     &lt;reg32&gt;,&lt;mem&gt;,&lt;con&gt;
// tag: 这里显然不能存储到 &lt;mem&gt; 所以该过程最多只有一次非读指令访存
//        如果乘法操作可能溢出，则编译器溢出标志 OF = 1，是CPU调溢出处理程序
</code></pre>
<p><strong>idiv 指令</strong><br>
带符号整数除法指令，他只有一个操作数，而被除数为 edx:eax中的内容（是拼接的64位整数），操作结果有两部分：商和余数，商-&gt;eax, 余数-&gt;edx</p>
<pre><code class="language-nasm">// (edx:eax) / op_1 = edx:eax
idiv     &lt;reg32&gt;
idiv     &lt;mem&gt;
// eg:
idiv     ebx
idiv     dword ptr [var]
</code></pre>
<p><strong>and/or/xor 指令</strong><br>
结果放在第一个操作数里</p>
<pre><code class="language-nasm">and     &lt;reg&gt;,&lt;reg&gt; / or &lt;reg&gt;,&lt;reg&gt; / xor &lt;reg&gt;,&lt;reg&gt;
and     &lt;reg&gt;,&lt;mem&gt; / or &lt;reg&gt;,&lt;mem&gt; / xor &lt;reg&gt;,&lt;mem&gt;
and     &lt;mem&gt;,&lt;reg&gt; / or &lt;mem&gt;,&lt;reg&gt; / xor &lt;mem&gt;,&lt;reg&gt;
and     &lt;reg&gt;,&lt;con&gt; / or &lt;reg&gt;,&lt;con&gt; / xor &lt;reg&gt;,&lt;con&gt;
and     &lt;mem&gt;,&lt;con&gt; / or &lt;mem&gt;,&lt;con&gt; / xor &lt;mem&gt;,&lt;con&gt;
// eg:
and     eax, 0fH
xor     edx, edx
</code></pre>
<p><strong>not 指令</strong><br>
位反转指令，将操作数每一位反转</p>
<pre><code class="language-nasm">not     &lt;reg&gt;
not     &lt;mem&gt;
// example:
not     byte ptr [var]
</code></pre>
<p><strong>neg 指令</strong><br>
取负指令</p>
<pre><code class="language-nasm">neg     &lt;reg&gt;
neg     &lt;mem&gt;
// eg:
neg     eax
</code></pre>
<p><strong>shl/shr 指令</strong><br>
逻辑移位指令， l 为左， r 为右，第一个操作数是被移位，第二个操作数是移位位数</p>
<pre><code class="language-nasm">shl     &lt;reg&gt;,&lt;con8&gt; / shr &lt;reg&gt;,&lt;con8&gt;
shl     &lt;mem&gt;,&lt;con8&gt; / shr &lt;mem&gt;,&lt;con8&gt;
shl     &lt;reg&gt;,&lt;cl&gt; / shr &lt;reg&gt;,&lt;cl&gt;
shl     &lt;mem&gt;,&lt;cl&gt; / shr &lt;mem&gt;,&lt;cl&gt;
// cl 是 8 位寄存器
// eg：
shl     eax, 1
shr     ebx cl
</code></pre>
<p><strong>标签</strong><br>
IP 寄存器是 CPU 硬件结构，其值是不能直接指定的，只能通过控制流指令来更改，在 x86 汇编中使用标签来标记代码地址</p>
<pre><code class="language-nasm">            movesi, [ebp+8]
begin:      xor ecx, ecx
            mov eax, [esi]
</code></pre>
<p><strong>jump 指令</strong><br>
直接跳转类似 goto 语句</p>
<pre><code class="language-nasm">jmp &lt;label&gt;
// eg:
jmp begin
</code></pre>
<p><strong>j&lt;condition&gt; 指令</strong><br>
条件转移指令</p>
<pre><code class="language-nasm">je      &lt;label&gt; (jump when equal)
jne     &lt;label&gt; (jump when not equal)
jz      &lt;label&gt; (jump when last result was zero)
jg      &lt;label&gt; (jump when greater than)
jge     &lt;label&gt; (jump when greater than or equal to)
jl      &lt;label&gt; (jump when less than)
jle     &lt;label&gt; (jump when less than or equal to)
// eg:
cmp eax, ebx
jle done
// tips:这里的跳转指令并不依赖某个寄存器的值，而是依赖 由cmp和test指令确定的 CPU 的状态值
</code></pre>
<p><strong>cmp/test 指令</strong><br>
cmp 用于比较两个操作数的值，test 对两个数进行逐位与运算，他们不保存操作结果，仅根据运算结果设置 CPU 状态字中的条件码</p>
<pre><code class="language-nasm">cmp     &lt;reg&gt;,&lt;reg&gt; / test &lt;reg&gt;,&lt;reg&gt;
cmp     &lt;mem&gt;,&lt;reg&gt; / test &lt;mem&gt;,&lt;reg&gt;
cmp     &lt;reg&gt;,&lt;mem&gt; / test &lt;reg&gt;,&lt;mem&gt;
cmp     &lt;reg&gt;,&lt;con&gt; / test &lt;reg&gt;,&lt;con&gt;
// tips:cmp,test和jcondotion指令搭配使用，举例：
cmp dword ptr [var], 10     // 比较 4 字节
jne loop                              // 相等继续执行，否则跳转到loop 
test eax, eax                       // 测试eax 是否为0
jz xxxx                                 // 为0则设置标志位 ZF 位1，跳转到 xxxx 处执行                               
</code></pre>
<p><strong>call/ret 指令</strong><br>
用于实现子程序（过程，函数等）的调用和返回， call 指令将当前执行的指令地址<strong>入栈</strong>，然后<strong>无条件转移</strong>到有标签指示的指令。call指令还会保存调用之前的信息。 ret 实现了子程序的返回机制，ret 指令<strong>弹出栈中保存的指令地址</strong>，然后无条件<strong>转移到保存的指令地址</strong>。</p>
<pre><code class="language-nasm">call &lt;label&gt;
ret
</code></pre>
<h3 id="过程调用机器表示">过程调用机器表示</h3>
<p>使用 call/ret 指令实现过程调用，假定过程<strong>P</strong>(调用者) 和 过程<strong>Q</strong>(被调用者)，过程调用步骤如下：</p>
<ul>
<li>P 将入口参数放在 Q 能访问到的地方</li>
<li>P 将返回地址存到特定的地方，然后将控制权转移到 Q (IP寄存器指向)</li>
<li>Q 保存 P 的现场(<strong>通用寄存器</strong>的内容)，并为自己的<strong>非静态局部变量</strong>分配空间</li>
<li>执行过程 Q</li>
<li>Q 回复 P 的现场，将结果放到 P 能访问到的地方，并释放局部变量所占空间</li>
<li>Q 取出返回地址，将控制转移到 P</li>
</ul>
<p><strong>注意   ：</strong> 上述步骤中需要为<strong>入口参数</strong>，<strong>返回地址</strong>，<strong>过程P现场</strong>，<strong>过程Q局部变量</strong>，<strong>返回结果</strong> 找到存放空间，而用户可见的寄存器数量是有限的，因此需要在内存中用一个栈来存放数据，EAX、ECX、EDX是<strong>调用者保存寄存器</strong>，其保存和恢复过程由P负责。EBX、ESI、EDI 是<strong>被调用则保存寄存器</strong>，每一个过程都有其自己的栈区，成为<strong>栈帧(Stack Frame)</strong>。寄存器 <strong>EBP指示栈底</strong>，<strong>ESP 指向栈顶</strong>，栈从高地址向低地址增长。</p>
<p><strong>例如</strong></p>
<pre><code class="language-c">// 被调用函数/过程
int add(int x, int y){
    return x + y;
}
// 调用者过程
int caller(){
    int temp1 = 125;
    int temp2 = 80;
    int sum = add(temp1, temp2);
    return sum;
}
</code></pre>
<p>经过 GCC 编译后 caller 过程的汇编码如下 ：</p>
<pre><code class="language-nasm">caller:
    # stage 1
    pushl       %ebp
    movl        %esp, %ebp        # 系统栈 &amp;&amp; 用户栈
                                  # ebp 和 esp 是 用户栈 指针
                                  # 而 push 指令是对系统栈的操作
                                  # 1. 将当前用户栈基址压入系统栈
                                  # 2. 新用户栈基址设为栈顶指针

    subl        $24, %esp         # 为当前过程开辟 24B 内存空间(栈帧)
                                  # 此时 esp = ebp - 24，所以栈顶指针更小
                                  # 这里 只用了 28B，是因为 GCC 规定栈帧必须是16B的整数倍

    # stage 2 定义变量
    movl        $125, -12(%ebp)   # 这里的变量是由 esp 向 ebp 方向依次放置
    movl        $80, -8(%ebp)

    # stage 3 传入函数参数
    movl        -8(%ebp), %eax  
    mov         %eax, 4(%esp)     # temp2 先入栈
    movl        -12(%ebp), %eax    
    movl        %eax, (%esp)      # temp1 后入栈

    # stage 4 调用函数
    call        add

    # stage 5 取出函数返回值
    movl        %eax, -4(%ebp)    # 将返回值取出到变量 sum
    movl        -4(%ebp), %eax    # 将 sum 作为返回值
                                  # 返回值是通过 eax 寄存器返回的，所以E(A|C|D)X寄存器是由调用者返回的

    # stage 6 离开 add 函数
    leave                         # 等价于：
                                  # movl     %ebp, %esp
                                  # popl     %ebp

    # stage 7 退出当前 caller 过程
    ret
</code></pre>
<p>add 过程对应过程的汇编码如下</p>
<pre><code class="language-nasm">    push       %ebp
    mov        %esp, %ebp
    mov        0xc(%ebp), %eax          # 将参数2放入寄存器
                                        # 这里的栈帧是有高位向低位
                                        # 函数参数是从右往左入栈

    mov        0x8(%ebp), %edx          # 将参数1放入寄存器

    lea        (%edx, %eax, 1), %eax    # 将add_1传入add_2
                                        # 这里是直接通过地址计算
                                        # 使用 lea 指令是因为不占用 ALU，比较快
                                        # 使用单指令代替了多条指令
    pop        %ebp
    ret
</code></pre>
<p><strong>Question</strong>：传入参数时是将参数的临时变量拷贝到了 4(%esp) 和 (%esp)，但是为什么在 add 过程中取参数时是取的 0xc(%ebp) 和 0x8(%ebp)？？</p>
<p><strong>Answer</strong>： 因为 call 指令会改变 esp 寄存器的值，会将函数返回地址入栈，然后 esp += 4</p>
<h3 id="选择语句机器表示">选择语句机器表示</h3>
<p>以 c 语言为例，选择语句主要是 <strong>if-then</strong>, <strong>if-then-else</strong>, <strong>switch</strong>, 编译器条件码(标志位)设置指令各类转移指令来实现选择结构语句</p>
<ol>
<li>
<p><strong>条件码（标志位）</strong></p>
<p>条件码是CPU维护的状态寄存器，他们描述算术逻辑操作的<strong>属性</strong>，可以检测这些寄存器来执行分支指令：</p>
<p><strong>CF</strong> 进(借)位标志，适用于最近的无符号整数加减运算，有进(借)位 CF = 1</p>
<p><strong>ZF</strong> 零标志，标志最近操作结果是否为0</p>
<p><strong>SF</strong> 符号标志，标志最近的带符号数运算结果，负 :SF = 1</p>
<p><strong>OF</strong> 溢出标志，标志最近带符号数运算结果是否溢出</p>
<p>由于OF，SF对无符号数无意义， CF对带符号数无意义，常见的算术逻辑运算指令都会设置条件码</p>
</li>
<li>
<p><strong>IF 语句</strong></p>
<p>通用形式如下</p>
<pre><code class="language-c">if(test_expr)
    then_statement
else
    else_statement
</code></pre>
<p>翻译为 goto 语句形式</p>
<pre><code class="language-c">t = test_expr;
if(!t)
    goto false;
then_statement
goto done;

false:
    else_statement
done:
</code></pre>
<p>对于下面的 c 语言函数</p>
<pre><code class="language-c">int get_count(int *p1, int *p2)
{
    if(p1 &gt; p2)
        return *p2;
    else
        return *p1;
}
</code></pre>
<p>将得到以下汇编码</p>
<pre><code class="language-nasm">movl     8(%ebp), %eax
movl     12(%ebp), %edx
cmpl     %edx %eax
jbe      .L1
movl     (%edx), %eax
jmp      .L2
.L1:
movl     (%eax), %eax
.L2:
</code></pre>
</li>
<li>
<p><strong>SWITCH 语句</strong></p>
<p>对于 <strong>小范围</strong> 和 <strong>小量</strong> 的选择语句，使用 <strong>跳转表</strong>，对于<strong>大范围</strong>或者<strong>大量</strong>的选择语句编译器还是会和 <strong>if-then-else</strong> 一样的方式来处理</p>
<p>跳转表即：</p>
<pre><code class="language-nasm">.L12:
    .long    .L3
    .long    .L4
    .long    .L5
    .long    .L6
    .long    .L7
    .long    .L8

</code></pre>
</li>
</ol>
<p>这样就可以通过 相对于 .L12 的<strong>偏移量</strong>来<strong>计算真实的跳转目的地了</strong>，这样的跳转只需一个指令来找到跳转目的，而不是多层的 if-else 嵌套，有点字典内味了。这也解释了为什么switch-case语句需要break来退出case，因为所有的case在<strong>地址上是连续</strong>的。</p>
<h3 id="循环语句机器表示">循环语句机器表示</h3>
<p>常规的循环语句 有<strong>while</strong>,<strong>for</strong>, <strong>do-while</strong> 大多数编译器都将上述三种形式的循环语句转化为<strong>do-while</strong> 语句</p>
<p><strong>DO-WHILE 循环</strong></p>
<pre><code class="language-c">do
    body_statement
    while(text_expr)
</code></pre>
<p>goto 语句形式</p>
<pre><code class="language-c">loop:
    body_statement
    t = test_expr;
    if(t)
        goto loop;
</code></pre>
<p><strong>WHILE循环</strong></p>
<pre><code class="language-c">while(test_expr)
    body_statement
</code></pre>
<p>在第一次执行循环体之前先执行一次</p>
<pre><code class="language-c">t = test_expr;
if(!t)
    goto done;
do
    body_statement
    while(text_expr);
done:
</code></pre>
<pre><code class="language-c">t = test_expr
if(!t)
    goto done;
loop:
    body_statement
    t = test_expr;
    if(t)
        goto loop;
done:
</code></pre>
<p><strong>FOR 循环</strong></p>
<p>一般形式</p>
<pre><code class="language-c">for(init_expr; test_expr; update_expr)
    body_statement
</code></pre>
<p>转化为 while 循环</p>
<pre><code class="language-c">init_expr;
while(test_expr){
    body_statement
    update_expr;
}
</code></pre>
<p>转化为 goto 语句</p>
<pre><code class="language-c">init_expr;
t = test_expr;
if(!t)
    goto done;

loop:
    body_statement
    update_expr;
    t = test_expr;
    if(t)
        goto loop;
done:   
</code></pre>
<pre><code class="language-c">int nsum_for(int n){
    int i;
    int result = 0;
    for(i = 1; i&lt;=n; i++)
        result += i;
    return result;
}
==== 编译 ====&gt;

movl        8(%ebp), %ecx
movl        $0, %eax
movl        $1, %edx
cmp         %edx, %ecx
jg          .L2
.L1:
addl        %edx, %eax
addl        $1, %edx
cmpl        %ecx, %edx
jle         .L1
.L2:
</code></pre>
<p>直接按照模板即可</p>

                                </div>
                            </div>
                            
                        </div>
                        <div class="post-footer">
                            <div class="post-copyright">
                                作者:
                                Island and Winds<br>永久链接:
                                    <a href="https://xuaii.github.io/post/ji-suan-ji-zhi-ling-xi-tong/" title="[计算机组成原理] 计算机指令系统">
                                        https://xuaii.github.io/post/ji-suan-ji-zhi-ling-xi-tong/
                                    </a><br> 协议: MIT License
                            </div>
                        </div>
                    </article>
                </div>
                <style>
                    .prev:hover {
                        color: #2d96bd;
                        text-decoration: none;
                        text-align: center;
                        transition: color 0.2s ease, border-color 0.2s ease, background 0.2s ease, opacity 0.2s ease;
                    }
                    
                    .next:hover {
                        color: #2d96bd;
                        text-decoration: none;
                        text-align: center;
                        transition: color 0.2s ease, border-color 0.2s ease, background 0.2s ease, opacity 0.2s ease;
                    }
                </style>
                <div class="lite-item nearby-article">
                    
                        <div class="nearby-article-left" style="padding: 10px;">
                            <a class="prev" rel="prev" href="https://xuaii.github.io/post/you-xi-ji-zhi-li-shi-jie-ji-zhi-you-hua/">
                                <i class="fa fa-chevron-left"></i>
                                [游戏机制] 里世界机制优化
                            </a>
                        </div>
                        
                            
                                <div class="nearby-article-right" style="padding: 10px;">
                                    <a class="next" rel="next" href="https://xuaii.github.io/post/wa-keng-nei-cun-guan-li-and-ecs/">
                                        [挖坑] 游戏引擎的并行架构 &amp;&amp; 内存管理 &amp;&amp; ECS<i class="fa fa-chevron-right"></i>
                                    </a>
                                </div>
                                
                </div>
                <!--Share-->
                <span style="margin-right:15px">
    <i class="post-share"></i>
    <span>&#x5206;&#x4EAB;:</span>
                <a title="QR 码" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://xuaii.github.io/post/ji-suan-ji-zhi-ling-xi-tong/"><i class="fa fa-qrcode"></i></a>
                <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://xuaii.github.io/post/ji-suan-ji-zhi-ling-xi-tong/&sharesource=qzone&title=[计算机组成原理] 计算机指令系统&pics=https://xuaii.github.io/images/avatar.png?v=1667771736332&summary="><i class="fa fa-qq"></i></a>
                <a title="新浪微博" target="_blank" href="https://service.weibo.com/share/share.php?url=https://xuaii.github.io/post/ji-suan-ji-zhi-ling-xi-tong/&sharesource=weibo&title=[计算机组成原理] 计算机指令系统 + " - " + &pic="https://xuaii.github.io/images/avatar.png?v=1667771736332"><i class="fa fa-weibo "></i></a>
                </span>
                
                                            
                                                <script type="application/javascript" src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
<div id="vlaine-comment"></div>
<script type="application/javascript">
    new Valine({
        el: '#vlaine-comment',
        appId: 'CYFKzMa2Qb2WGxCgVV2PLhit-gzGzoHsz',
        appKey: 'NafP7wLckvLJOXjRfRJ6SV7C',
        pageSize: 10,
        avatar: 'mp',
        placeholder: '来都来了，不妨评论一下',
        visitor: true,
        highlight: true,
        recordIP: true,
    })
</script>
                                                    
            </div>
            <div id="sidebar">
    <ul>
        
            <li class="lite-item">
                <header class="lite-item-header">
                    <h3 class="lite-item-title"><i class="Card Card-hitokoto"></i>&nbsp;&#x4E00;&#x8A00;</h3>
                </header>
                <div class="textwidget">
                    <p>
                        <b id="hitokoto"></b>
                    </p>
                </div>
            </li>
            
                <!--
                <li class="lite-item">
                    <header class="lite-item-header">
                        <h3 class="lite-item-title"><i class="Card Card-tags">&#x6807;&#x7B7E;</i></h3>
                    </header>
                    <div class="textwidget">
                        
                            <a href="" class="tag-cloud-link " style="font-size: 12px;margin: 5px; padding: 2px;">
                                <i class="fa fa-tags" aria-hidden="true"></i>
                            </a>
                            
                    </div>
                </li>-->
                <li class="lite-item">
                    <header class="lite-item-header">
                        <h3 class="lite-item-title"><i class="Card Card-tags">&#x6807;&#x7B7E;</i></h3>
                    </header>
                    <div class="textwidget">
                        <div id='tags' style="height: auto;width: 360;"></div>
                        <script src="https://xuaii.github.io/media/js/svg3dtagcloud.min.js"></script>
                        <script>
                            $(document).ready(function() {
                                var entries = ([
                                    
                                     {
                                        label: '🏷idea',
                                        url: 'https://xuaii.github.io/tag/RH8VFDFV9/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷优化',
                                        url: 'https://xuaii.github.io/tag/3u8paddqN/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷关卡设计',
                                        url: 'https://xuaii.github.io/tag/4wlI74y2BW/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷Godot',
                                        url: 'https://xuaii.github.io/tag/n-3KDzmbKR/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷游戏机制',
                                        url: 'https://xuaii.github.io/tag/RXsLi4wHZ/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷计算机组成原理',
                                        url: 'https://xuaii.github.io/tag/q7ogHTpxn/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷CPU',
                                        url: 'https://xuaii.github.io/tag/nk7eMi6weI/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷指令集',
                                        url: 'https://xuaii.github.io/tag/y0QD2lmwzR/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷我的世界',
                                        url: 'https://xuaii.github.io/tag/Oe6pf-JNw/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷编译原理',
                                        url: 'https://xuaii.github.io/tag/-xYITLanXJ/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷自动化',
                                        url: 'https://xuaii.github.io/tag/QU-T8fr1fk/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷挖坑',
                                        url: 'https://xuaii.github.io/tag/aYIh6YBFp/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷摘抄',
                                        url: 'https://xuaii.github.io/tag/aMOS10oo8/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷c++',
                                        url: 'https://xuaii.github.io/tag/z4Tg_U8wV/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷反射',
                                        url: 'https://xuaii.github.io/tag/S6muC6Uh7u/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷godot',
                                        url: 'https://xuaii.github.io/tag/Dqmvh-Mfk/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷编辑器插件',
                                        url: 'https://xuaii.github.io/tag/2btgH2JlXq/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷游戏开发',
                                        url: 'https://xuaii.github.io/tag/jy5L0E1G3/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷总结',
                                        url: 'https://xuaii.github.io/tag/qmCbMC82l_/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷数学',
                                        url: 'https://xuaii.github.io/tag/NODlbSy7k/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷决策树',
                                        url: 'https://xuaii.github.io/tag/zPTyWgNBT/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷机器学习',
                                        url: 'https://xuaii.github.io/tag/cJZOT8XITZ/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷线性模型',
                                        url: 'https://xuaii.github.io/tag/49U0AO548/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷神经网络',
                                        url: 'https://xuaii.github.io/tag/YsZNZqLqv/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷SVM',
                                        url: 'https://xuaii.github.io/tag/TUnAlz6DG/',
                                        target: '_button'
                                    },
                                    
                                    
                                     {
                                        label: '🏷转载',
                                        url: 'https://xuaii.github.io/tag/QvoiM26MU/',
                                        target: '_button'
                                    }
                                    
                                    
                                ]);
                                var settings = {
                                    entries: entries, //数据
                                    width: 300, //宽度
                                    height: 300, //高度
                                    radius: '50%',
                                    radiusMin: 50,
                                    bgDraw: false, //是否显示背景
                                    bgColor: '#fff', //背景颜色
                                    opacityOver: 1.00,
                                    opacityOut: 0.05,
                                    opacitySpeed: 6,
                                    fov: 360,
                                    speed: 0.3, //旋转的速度
                                    fontFamily: 'Oswald, Arial, sans-serif',
                                    fontSize: '18', //默认字体大小
                                    fontColor: '#666', //默认字体颜色
                                    fontWeight: 'normal', //bold
                                    fontStyle: 'normal', //italic 
                                    fontStretch: 'normal', //wider, narrower, ultra-condensed, extra-condensed, condensed, semi-condensed, semi-expanded, expanded, extra-expanded, ultra-expanded
                                    fontToUpperCase: true,
                                    tooltipFontFamily: 'Oswald, Arial, sans-serif',
                                    tooltipFontSize: '16',
                                    tooltipFontColor: 'red',
                                    tooltipFontWeight: 'normal', //bold
                                    tooltipFontStyle: 'normal', //italic 
                                    tooltipFontStretch: 'normal', //wider, narrower, ultra-condensed, extra-condensed, condensed, semi-condensed, semi-expanded, expanded, extra-expanded, ultra-expanded
                                    tooltipFontToUpperCase: false,
                                    tooltipTextAnchor: 'left',
                                    tooltipDiffX: 0,
                                    tooltipDiffY: 5

                                };

                                //var svg3DTagCloud = new SVG3DTagCloud( document.getElementById( 'holder'  ), settings );
                                $('#tags').svg3DTagCloud(settings);
                            });
                        </script>
                    </div>
                </li>
                
                    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/APlayer.min.js"></script>
                    <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
                    <div id="player"></div>
                    
                        <li class="lite-item">
                            <header class="lite-item-header">
                                <h3 class="lite-item-title">
                                    &#x1F3B5;&#x97F3;&#x4E50;
                                </h3>
                            </header>
                            <div class="textwidget">
                                <p>
                                    <div id="playerbox"></div>
                                </p>
                            </div>
                        </li>
                        
                            <script>
                                function LoadPlayer() {
                                    var music_array = [];
                                    
                                    music_array.push({
                                        name: '马里奥-Ground',
                                        url: 'http://music.163.com/song/media/outer/url?id=31719143.mp3',
                                        artist: '',
                                        cover: 'http://p2.music.126.net/CSH0Y-N4RWqCNmJBt3yT-Q==/19211766672383482.jpg?param=50y50',
                                    });
                                    
                                    
                                    const ap = new APlayer({
                                        container: document.getElementById('playerbox'),
                                        audio: music_array
                                    });
                                    
                                }
                                LoadPlayer();
                            </script>
                            
                                
                                    
                                        
                                            <li class="lite-item">
                                                <header class="lite-item-header">
                                                    <h3 class="lite-item-title">
                                                        
                                                    </h3>
                                                </header>
                                                <div class="textwidget">
                                                    <div id="textwidget-box" style="width:100%; height:auto;">
                                                        
                                                    </div>
                                                </div>
                                            </li>
                                            
                                                
                                                    <li class="lite-item">
                                                        <header class="lite-item-header">
                                                            <h3 class="lite-item-title">&#x1F468;&#x200D;&#x1F4BB;&#x53CB;&#x94FE;</h3>
                                                        </header>
                                                        <div class="textwidget">
                                                            
                                                                
                                                                    <p onclick="javascript:top.location='https://blog.itjoker.cn'"><span class="link_a"><a href="https://blog.itjoker.cn" alt="ITJoker ">ITJoker -ITJoker&#39;s Blog</a></span></p>

                                                                    
                                                                    <p onclick="javascript:top.location='https://mirror.xyz/opang.eth'"><span class="link_a"><a href="https://mirror.xyz/opang.eth" alt="opang.eth ">opang.eth -opang&#39;s web3 blog</a></span></p>

                                                                    
                                                                    <p onclick="javascript:top.location='https://blog.csdn.net/qq_40654505/category_10121252.html'"><span class="link_a"><a href="https://blog.csdn.net/qq_40654505/category_10121252.html" alt="椰奶冻不安全 ">椰奶冻不安全 -椰奶冻不安全 &#39;s blog</a></span></p>

                                                                    
                                                                        
                                                        </div>
                                                    </li>
    </ul>
</div>
        </div>

</body>
<footer id="foot">
    <a class="back-to-top" href="#"><i class="Card Card-top" ></i><span class="back-to-top-text">0%</span></a>
    <div class="copyright">
        Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
            
                    

                        <div style="font-size:12px">
                            
                                        已经建站 <b id='build_time'></b>
                        </div>
                        <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io/CDN/js/time.min.js"></script>
                        <script>
                            buildTime = '2022.8.1'
                            setInterval(show_date_time, 1000, buildTime);
                        </script>
                        
                            <a href="">
                                Theme - Card
                            </a>&nbsp;|&nbsp; &#x7248;&#x6743;&#x6240;&#x6709; &copy;
                            <script>
                                var date = new Date();
                                data2 = new Date(buildTime.replace(/-/g, "/"));
                                nowYear = date.getFullYear().toString()
                                buildYear = data2.getFullYear().toString();
                                if (buildYear == nowYear) {
                                    document.write('<span class="my-face">' + nowYear + '</span>');
                                } else {
                                    document.write(buildYear + '-<span class="my-face">' + nowYear + '</span>');
                                }
                            </script>

                            <a href="https://xuaii.github.io">
                                Island and Winds
                                <a target="_blank" href="https://pages.github.com/" title="">Powered by Github Pages</a>
                                
                            </a>
    </div>
    <script>
        let back2TopText = document.querySelector('.back-to-top-text')
        window.addEventListener('scroll', function(e) {
            let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
            if (back2TopText) {
                back2TopText.textContent = Math.floor(percent).toString() + '%';
            }
        });
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            document.hidden ? (document.title = "\uD83D\uDE25" + OriginTitile, clearTimeout(titleTime)) : (document.title = "\uD83D\uDE1D" + OriginTitile, titleTime = setTimeout(function() {
                document.title = OriginTitile
            }, 2E3))
        });
        var OriginTitile = document.title;
        
        App.hitokoto();
        
        
        App.weather();
        
        var themeIcon = document.getElementById("themeIcon");
        const currentTheme = window.localStorage.getItem('theme');
        App.clearLog();
        App.outputlog();
        var logo = '%cIsland and Winds\'%cBlog';
        $('img').attr('data-fancybox', 'images');
    </script>
</footer>
    <script>
        renderMathInElement(document.body, {
            delimiters: [{
                left: "$$",
                right: "$$",
                display: true
            }, {
                left: "$",
                right: "$",
                display: false
            }]
        });
    </script>

</html>